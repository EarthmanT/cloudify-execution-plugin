plugins:

  exec:
    executor: central_deployment_agent
    package_name: cloudify-execution-plugin
    package_version: '0.4.0'

data_types:

  cloudify.types.exec.Package:
    properties:
      resource_dir:
        description: >
          A directory under the blueprint root,
          which content needs to be copied and kept unchanged.
        default: ''
      resource_list:
        description: >
          A list of file paths under the blueprint root,
          which need to be filled with values of template_variables.
        default: []
      template_variables:
        description: A dict containing variables as key-values.
        default: {}

  cloudify.types.exec.RemoteHost:
    properties:
      username:
        default: centos
      ip:
        default: ''
      keypath:
        default: ''

node_types:

  cloudify.nodes.Execution:
    derived_from: cloudify.nodes.SoftwareComponent
    properties:
      resource_config:
        type: cloudify.types.exec.Package
        required: false
      remote_executor:
        type: cloudify.types.exec.RemoteHost
        required: false
      files_to_copy:
        required: false
    interfaces:
      cloudify.interfaces.lifecycle:
        create: &exec_op
          implementation: exec.exec_plugin.tasks.execute
          inputs:
            resource_config:
              type: cloudify.types.exec.Package
              default: { get_property: [ SELF, resource_config ] }
            files_to_copy:
              default: { get_property: [ SELF, files_to_copy ] }
            file_to_source:
              type: string
              default: exec
